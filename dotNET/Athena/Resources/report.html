<html>
<head>
    <meta charset="UTF-8" />
    <title>Convert Log</title>
    <style>
            .Error {{
                color: red;
            }}

            .Warning {{
                color: gray;
            }}

            .Info {{
                color: black;
            }}
        table, th, td {{
                border: 1px solid black;
                border-spacing: 0px;
            }}
    </style>
    <script type="text/javascript">
        var report = {2}
    </script>
    </head>
<body>
    <div class="header">
        <h1 class="title">ASTA Test Repport</h1>
        <p class="runDate">Dato for report kørsel: {0}</p>
    </div>
    <div class="content">
        <h3>Afleveringspakke ID: {1}</h3>
        <p>Report startet</p>
        <div class="results" id="testContent">
            <p>Antal tabeller</p>
            <table>
                <tr><th></th><th>Før</th><th>Efter</th></tr>
                <tr><td>Antal tabeller</td><td id="tablesBefore">0</td><td id="tablesAfter">0</td></tr>
                <tr><td>Antal kodetabeller</td><td id="codeListsBefore">0</td><td id="codeListsAfter">0</td></tr>
            </table>
            <br />
            <p>Antal rækker</p>
            <table id="rowsTable">
                <tr><th>Tabel</th><th>Før</th><th>Efter</th></tr>
            </table>
        </div>
    </div>
    <script type="text/javascript">
        if (!String.prototype.format) {{
            String.prototype.format = function () {{
                var args = arguments;
                return this.replace(/{{(\d+)}}/g, function (match, number) {{
                    return typeof args[number] != 'undefined'
                        ? args[number]
                        : match
                        ;
                }});
            }};
        }}
        var rowsTable = document.getElementById("rowsTable");
        var rowHtml = "<tr><td>{{0}} ({{1}})</td><td{{4}}>{{2}}</td><td{{4}}>{{3}}</td></tr>";

        (function () {{
            UpdateRow("tablesBefore", "tablesAfter", report.Tables.length, report.TablesCounter);
            var codeLists = 0;
            for (var i = 0; i < report.Tables.length; i++) {{
                UpdateTableInfo(report.Tables[i]);
                codeLists += report.Tables[i].CodeList.length;
                for (var j = 0; j < report.Tables[i].CodeList.length; j++) {{
                    UpdateTableInfo(report.Tables[i].CodeList[j]);
                }}
            }}
            UpdateRow("codeListsBefore", "codeListsAfter", codeLists, report.CodeListsCounter);
         }})();
        function UpdateTableInfo(table) {{
                var className = (table.Rows !== table.RowsCounter) ? " class=\"Error\"" : "";
                rowsTable.insertAdjacentHTML("beforeend", rowHtml.format(table.Folder, table.Name, table.Rows, table.RowsCounter, className));
        }}
        function UpdateRow(beforeId, afterId, beforeValue, afterValue) {{
            var before = document.getElementById(beforeId);
            var after = document.getElementById(afterId);
            before.innerText = beforeValue;
            after.innerText = afterValue;
            if (beforeValue !== afterValue) {{
                before.className = "Error";
                after.className = "Error";
            }}
        }}        
    </script>
</body>
</html>
